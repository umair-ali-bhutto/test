<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

     <script>
    // Import functions from Web Crypto API
    const subtleCrypto = crypto.subtle;
    const textEncoder = new TextEncoder();
    // const textDecoder = new TextDecoder();

    // This function will contain your asynchronous code
    async function runEncryptionExample() {
      const encryptionKey = await generateKey();

      async function generateKey() {
        return await subtleCrypto.generateKey(
          {
            name: 'AES-GCM',
            length: 256, // Key length in bits
          },
          true, // Can be used for encryption
          ['encrypt', 'decrypt'] // Key usages
        );
      }

      async function encryptData(data, key) {
        const encodedData = textEncoder.encode(data);
        const encryptedData = await subtleCrypto.encrypt(
          {
            name: 'AES-GCM',
            iv: new Uint8Array([0x12, 0x34, 0x56, 0x78, 0x90, 0xAB, 0xCD, 0xEF]),
          },
          key,
          encodedData
        );
        return encryptedData;
      }

    //   async function decryptData(encryptedData, key) {
    //     const decryptedData = await subtleCrypto.decrypt(
    //       {
    //         name: 'AES-GCM',
    //         iv: new Uint8Array([0x12, 0x34, 0x56, 0x78, 0x90, 0xAB, 0xCD, 0xEF]),
    //       },
    //       key,
    //       encryptedData
    //     );
    //     const decodedData = textDecoder.decode(decryptedData);
    //     return decodedData;
    //   }


      
      
      const dataToEncrypt = 'Hello, this is a secret message!';
      const encryptedData = await encryptData(dataToEncrypt, encryptionKey);


      localStorage.setItem('data', JSON.stringify(Array.from(new Uint8Array(encryptedData))));
      localStorage.setItem('key', JSON.stringify(Array.from(new Uint8Array(encryptionKey))));

    //   // Retrieve and decrypt the data from localStorage
    //   const storedEncryptedData = new Uint8Array(JSON.parse(localStorage.getItem('data')));
    //   const decryptedMessage = await decryptData(storedEncryptedData, encryptionKey);
    //   console.log('Decrypted Message:', decryptedMessage);
    
    }

    // Call the async function to start the encryption example
    runEncryptionExample();

   
  </script>

<a  href="nextPage.html"> go forward </a>
 
</body>
</html>